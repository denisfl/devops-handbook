# –î–µ–Ω—å 5. Python –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

[tools] [devops] [python] [automation]

–õ—é–±–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–≤–æ–π –ø—É—Ç—å —Å Bash. –≠—Ç–æ —Ä–æ–¥–Ω–æ–π —è–∑—ã–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞, –∏–¥–µ–∞–ª—å–Ω—ã–π –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á: "—Å–∫–æ–ø–∏—Ä—É–π —Ñ–∞–π–ª—ã", "–∑–∞–ø—É—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä", "—É–¥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏".
–ù–æ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç Bash –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ª–æ–≤—É—à–∫—É. –í—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å JSON-–æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É—è `grep`, `sed` –∏ `awk`. –í–∞—à —Å–∫—Ä–∏–ø—Ç –æ–±—Ä–∞—Å—Ç–∞–µ—Ç –∫–æ—Å—Ç—ã–ª—è–º–∏, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ—á–∏—Ç–∞–µ–º—ã–º –∏ —Ö—Ä—É–ø–∫–∏–º.
–í —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç –Ω–∞ —Å—Ü–µ–Ω—É –≤—ã—Ö–æ–¥–∏—Ç **Python**. –≠—Ç–æ "–∫–ª–µ–π", –∫–æ—Ç–æ—Ä—ã–π —Å–æ–µ–¥–∏–Ω—è–µ—Ç —Ä–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –≤ –µ–¥–∏–Ω—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É.

---

## –ü–æ—á–µ–º—É Python —Å—Ç–∞–ª —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º –≤ DevOps?

–ï—Å–ª–∏ Bash ‚Äî —ç—Ç–æ –º–æ–ª–æ—Ç–æ–∫, —Ç–æ Python ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–æ–∫ —Å –ß–ü–£.

1.  **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**. –ö–æ–¥ –Ω–∞ Python —á–∞—Å—Ç–æ —á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π —Ç–µ–∫—Å—Ç. –í Ops-–∫–æ–º–∞–Ω–¥–∞—Ö, –≥–¥–µ –∏–Ω–∂–µ–Ω–µ—Ä—ã —á–∞—Å—Ç–æ —Å–º–µ–Ω—è—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞, —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ.
2.  **–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö**. Bash –æ–ø–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∞–º–∏. Python –¥–∞–µ—Ç –Ω–∞–º –°–ø–∏—Å–∫–∏ –∏ –°–ª–æ–≤–∞—Ä–∏. –ê —Ç–∞–∫ –∫–∞–∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∏—Ä (AWS, Kubernetes, REST API) —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç –Ω–∞ —è–∑—ã–∫–µ JSON, Python —Å –µ–≥–æ —Å–ª–æ–≤–∞—Ä—è–º–∏ (`dict`) —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–∞—Ç–∏–≤–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º.
3.  **–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞**. –ù—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram? `import telebot`. –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ SQL –±–∞–∑—ã? `import psycopg2`. –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –≤–µ–ª–æ—Å–∏–ø–µ–¥—ã.

### –ê–Ω–∞—Ç–æ–º–∏—è —Å–∫—Ä–∏–ø—Ç–∞

–ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –æ–±—ã—á–Ω–æ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ —à–∞–±–ª–æ–Ω—É:

1.  **Imports**: –ü–æ–¥–∫–ª—é—á–∞–µ–º –±–∞—Ç–∞—Ä–µ–π–∫–∏ (`os`, `sys`, `requests`).
2.  **Config**: –í—ã–Ω–æ—Å–∏–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã (URL, —Ç–æ–∫–µ–Ω—ã) –≤ –Ω–∞—á–∞–ª–æ –∏–ª–∏ —á–∏—Ç–∞–µ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.
3.  **Functions**: –†–∞–∑–±–∏–≤–∞–µ–º –ª–æ–≥–∏–∫—É –Ω–∞ –∞—Ç–æ–º–∞—Ä–Ω—ã–µ –∫—É—Å–∫–∏.
4.  **Entry Point**: –ë–ª–æ–∫ `if __name__ == "__main__":`, –æ—Ç–∫—É–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ.

### –≠–∫–æ–ª–æ–≥–∏—è: Virtual Environments

–ü—Ä–µ–∂–¥–µ —á–µ–º –ø–∏—Å–∞—Ç—å –∫–æ–¥, –∑–∞–ø–æ–º–Ω–∏—Ç–µ –≥–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ Python-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞: **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ç–∞–≤—å—Ç–µ –ø–∞–∫–µ—Ç—ã –≤ —Å–∏—Å—Ç–µ–º–Ω—ã–π Python**.
–í Linux —Å–∏—Å—Ç–µ–º–Ω—ã–π Python –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–∞–º–æ–π –û–° (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–∞–∫–µ—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä `dnf` –∏–ª–∏ `apt` –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ Python). –ï—Å–ª–∏ –≤—ã —Å–¥–µ–ª–∞–µ—Ç–µ `sudo pip install requests` –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –≤–µ—Ä—Å–∏—é –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –≤—ã –º–æ–∂–µ—Ç–µ —Å–ª–æ–º–∞—Ç—å –ø–æ–ª–æ–≤–∏–Ω—É —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç.

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Virtual Environments (venv)**. –≠—Ç–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–µ—Å–æ—á–Ω–∏—Ü—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

```bash
# –°–æ–∑–¥–∞–µ–º –ø–µ—Å–æ—á–Ω–∏—Ü—É –≤ –ø–∞–ø–∫–µ .venv
python3 -m venv .venv

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –µ—ë (–º–µ–Ω—è–µ—Ç –ø—É—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)
source .venv/bin/activate

# –¢–µ–ø–µ—Ä—å pip —Å—Ç–∞–≤–∏—Ç –ø–∞–∫–µ—Ç—ã —Ç–æ–ª—å–∫–æ —Å—é–¥–∞
pip install requests
```

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: Safety First

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —É—á–µ–±–Ω—ã—Ö –∑–∞–¥–∞—á, –≤ —Ä–µ–∞–ª—å–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–µ –≤—Å—ë –ª–æ–º–∞–µ—Ç—Å—è. –°–µ—Ç—å –º–æ—Ä–≥–∞–µ—Ç, –¥–∏—Å–∫ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è, API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 500-—é –æ—à–∏–±–∫—É.
Bash –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–¥–µ—Ç –¥–∞–ª—å—à–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ —É–ø–∞–ª–∞ (–µ—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á–∏—Ç—å `set -e`). Python –±—Ä–æ—Å–∞–µ—Ç **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ (Exception)**.
–ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `try / except` ‚Äî —ç—Ç–æ –≤–∞—à —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –ø–æ–ª–∏—Å. –û–Ω–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä–∏–ø—Ç—É –ø–µ—Ä–µ–∂–∏—Ç—å —Å–±–æ–π –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ, –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –º–æ–ª—á–∞ —É–ø–∞—Å—Ç—å.

---

## –ü—Ä–∞–∫—Ç–∏–∫–∞

### 1. Health Check 2.0

–†–∞–∑–±–µ—Ä–µ–º –∫–ª–∞—Å—Å–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É: –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–∞. –ù–∞ Bash —ç—Ç–æ –∑–∞–Ω—è–ª–æ –±—ã —Å—Ç—Ä–æ–∫ 10 —Å `curl`. –ù–∞ Python —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç —á—É—Ç—å –æ–±—ä–µ–º–Ω–µ–µ, –Ω–æ –¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å.

–°–∫—Ä–∏–ø—Ç `check_site.py`:

```python
import requests  # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
import time
from datetime import datetime

URL = "https://google.com"

def check_url(url):
    try:
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º GET –∑–∞–ø—Ä–æ—Å —Å —Ç–∞–π–º–∞—É—Ç–æ–º 5 —Å–µ–∫—É–Ω–¥
        response = requests.get(url, timeout=5)

        # –ï—Å–ª–∏ —Å—Ç–∞—Ç—É—Å 200 (–û–ö)
        if response.status_code == 200:
            return True, response.elapsed.total_seconds()
        else:
            print(f"‚ö†Ô∏è Status code: {response.status_code}")
            return False, 0

    except requests.exceptions.ConnectionError:
        print("‚ùå Connection Error: DNS failure or Refused")
    except requests.exceptions.Timeout:
        print("‚è∞ Timeout: Server is too slow")

    return False, 0

if __name__ == "__main__":
    print(f"Starting monitoring for {URL}...")
    while True:
        is_up, duration = check_url(URL)
        timestamp = datetime.now().strftime("%H:%M:%S")

        if is_up:
            print(f"[{timestamp}] ‚úÖ UP ({duration:.2f}s)")
        else:
            print(f"[{timestamp}] ‚ùå DOWN")

        time.sleep(5)
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –º—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å "—Å–∞–π—Ç –ª–µ–∂–∏—Ç" –æ—Ç "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç –ø—Ä–æ–ø–∞–ª".

### 2. –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ (Log Parsing)

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ª–æ–≥-—Ñ–∞–π–ª –Ω–∞ 10 –ì–∏–≥–∞–±–∞–π—Ç. –ó–∞–≥—Ä—É–∂–∞—Ç—å –µ–≥–æ —Ü–µ–ª–∏–∫–æ–º –≤ –ø–∞–º—è—Ç—å (`f.read()`) –Ω–µ–ª—å–∑—è ‚Äî —Å–µ—Ä–≤–µ—Ä –∑–∞–≤–∏—Å–Ω–µ—Ç.
Python –ø–æ–∑–≤–æ–ª—è–µ—Ç —á–∏—Ç–∞—Ç—å —Ñ–∞–π–ª **–ø–æ—Å—Ç—Ä–æ—á–Ω–æ**, –∫–∞–∫ –ø–æ—Ç–æ–∫–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä.

–°–æ–∑–¥–∞–¥–∏–º `server.log`:

```text
INFO: User A logged in
ERROR: Database connection failed
INFO: User B logged in
CRITICAL: Out of memory
ERROR: Timeout
```

–°–∫—Ä–∏–ø—Ç `analyzer.py`:

```python
LOG_FILE = "server.log"

error_count = 0
critical_count = 0

print(f"Analyzing {LOG_FILE}...")

# –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è 'with' –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —Ñ–∞–π–ª–∞
with open(LOG_FILE, "r") as f:
    # –ò—Ç–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ç—Ä–æ–∫–∞ –∑–∞ —Å—Ç—Ä–æ–∫–æ–π, –ø–∞–º—è—Ç—å –Ω–µ —Ç—Ä–∞—Ç–∏—Ç—Å—è
    for line in f:
        line = line.strip() # –£–±–∏—Ä–∞–µ–º –ø—Ä–æ–±–µ–ª—ã –∏ –ø–µ—Ä–µ–Ω–æ—Å —Å—Ç—Ä–æ–∫–∏

        if "ERROR" in line:
            print(f"Found Error: {line}")
            error_count += 1
        elif "CRITICAL" in line:
            print(f"üî• CRITICAL: {line}")
            critical_count += 1

print("-" * 20)
print(f"Report: {error_count} errors, {critical_count} critical failures.")
```

### 3. –†–∞–±–æ—Ç–∞ —Å API (JSON)

DevOps —á–∞—Å—Ç–æ –ø–µ—Ä–µ–∫–ª–∞–¥—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–¥–Ω–æ–≥–æ API –≤ –¥—Ä—É–≥–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏–∑ AWS –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥).
Python –Ω–∞—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å JSON: –æ–Ω –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ —Å–ª–æ–≤–∞—Ä—å.

```python
import requests

# –ü—É–±–ª–∏—á–Ω–æ–µ API –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è IP
url = "https://api.ipify.org?format=json"

try:
    r = requests.get(url)
    data = r.json() # –ü–∞—Ä—Å–∏–º –æ—Ç–≤–µ—Ç (JSON -> Dict)

    print(f"Raw data: {data}")
    print(f"My IP: {data['ip']}")

except Exception as e:
    print(f"Error: {e}")
```

---

## –†–µ—Å—É—Ä—Å—ã

- **[Automate the Boring Stuff with Python](https://automatetheboringstuff.com/)** ‚Äî –ö—É–ª—å—Ç–æ–≤–∞—è –∫–Ω–∏–≥–∞. –ï—Å–ª–∏ –≤—ã –Ω–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å –Ω–µ—ë. –û–Ω–∞ —É—á–∏—Ç —Ä–µ—à–∞—Ç—å –±—ã—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏, –∞ –Ω–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.
- **[Python for DevOps](https://www.oreilly.com/library/view/python-for-devops/9781492057680/)** ‚Äî –ö–Ω–∏–≥–∞ –æ—Ç O'Reilly, –∑–∞—Ç–æ—á–µ–Ω–Ω–∞—è –ø–æ–¥ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∑–∞–¥–∞—á–∏.
- **[Real Python](https://realpython.com/)** ‚Äî –õ—É—á—à–∏–π —Å–±–æ—Ä–Ω–∏–∫ —Ç—É—Ç–æ—Ä–∏–∞–ª–æ–≤ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ.
